# SQL-Interview-Prep
it's a SQL Interview Prep Repo. If you will follow up this, you will almost gonna clear most of the SQL interview questions. I refer Datalemur.

# DAY-1
  ## Question: 

This is the same question as problem #6 in the SQL Chapter of Ace the Data Science Interview!

Assume you're given a table Twitter tweet data, write a query to obtain a histogram of tweets posted per user in 2022. Output the tweet count per user as the bucket and the number of Twitter users who fall into that bucket.

In other words, group the users by the number of tweets they posted in 2022 and count the number of users in each group.

Full Question Link: [Link](https://datalemur.com/questions/sql-histogram-tweets)

## Solution: 

![Solution](https://github.com/Ramakm/SQL-Interview-Prep/assets/8182816/ac180d7b-e4e4-4fe5-b875-53ca3baa6f62)

# DAY-2
  ## Question: 

Given a table of candidates and their skills, you're tasked with finding the candidates best suited for an open Data Science job. You want to find candidates who are proficient in Python, Tableau, and PostgreSQL.

Write a query to list the candidates who possess all of the required skills for the job. Sort the output by candidate ID in ascending order.

Full Question Link: [Link](https://datalemur.com/questions/matching-skills)

## Solution: 

![Solution](![image](https://github.com/Ramakm/SQL-Interview-Prep/assets/8182816/c61b1d8a-047c-4f3f-a4b7-373456ac91f0)


# DAY-3
  ## Question: Page With No Likes [Facebook SQL Interview Question]

Assume you're given two tables containing data about Facebook Pages and their respective likes (as in "Like a Facebook Page").

Write a query to return the IDs of the Facebook pages that have zero likes. The output should be sorted in ascending order based on the page IDs.

Full Question Link: [Link](https://datalemur.com/questions/sql-page-with-no-likes)

## Solution: 

![Solution](https://github.com/Ramakm/SQL-Interview-Prep/assets/8182816/43c9c8af-a726-4bb2-bd77-ad471791e94c)

# DAY-4
  ## Question: Laptop vs. Mobile Viewership [New York Times SQL Interview Question]


Assume you're given the table on user viewership categorised by device type where the three types are laptop, tablet, and phone.

Write a query that calculates the total viewership for laptops and mobile devices where mobile is defined as the sum of tablet and phone viewership. Output the total viewership for laptops as laptop_reviews and the total viewership for mobile devices as mobile_views.

Effective 15 April 2023, the solution has been updated with a more concise and easy-to-understand approach.
Full Question Link: [Link](https://datalemur.com/questions/laptop-mobile-viewership)

## Solution: 

![Solution](https://github.com/Ramakm/SQL-Interview-Prep/assets/8182816/b7a5a9ea-9b13-4e92-a353-8ae16e65b937)

# DAY-5
  ## Question: Average Post Hiatus (Part 1) [Facebook SQL Interview Question]

Given a table of Facebook posts, for each user who posted at least twice in 2021, write a query to find the number of days between each user’s first post of the year and last post of the year in the year 2021. Output the user and number of the days between each user's first and last post.

Full Question Link: [Link](https://datalemur.com/questions/sql-average-post-hiatus-1)

## Solution: 
![Solution](https://github.com/Ramakm/SQL-Interview-Prep/assets/8182816/ecbee351-f664-4dfb-a913-86ac11d883a5)


# DAY-6
  ## Question: Teams Power Users [Microsoft SQL Interview Question]

Write a query to identify the top 2 Power Users who sent the highest number of messages on Microsoft Teams in August 2022. Display the IDs of these 2 users along with the total number of messages they sent. Output the results in descending order based on the count of the messages.

Assumption:

No two users have sent the same number of messages in August 2022.

Full Question Link: [Link](https://datalemur.com/questions/teams-power-users)

## Solution: 
![Solution](https://github.com/Ramakm/SQL-Interview-Prep/assets/8182816/4a112188-7bea-4cb3-b2f2-ddd2b0862c46)

# DAY-7
  ## Question: Sending vs. Opening Snaps [Snapchat SQL Interview Question]
Assume you're given tables with information on Snapchat users, including their ages and time spent sending and opening snaps.

Write a query to obtain a breakdown of the time spent sending vs. opening snaps as a percentage of total time spent on these activities grouped by age group. Round the percentage to 2 decimal places in the output.

Notes:

Calculate the following percentages:
* time spent sending / (Time spent sending + Time spent opening)
* Time spent opening / (Time spent sending + Time spent opening)
* To avoid integer division in percentages, multiply by 100.0 and not 100.

Full Question Link: [Link](https://datalemur.com/questions/time-spent-snaps)

## Solution: 

![Solution](https://github.com/Ramakm/SQL-Interview-Prep/assets/8182816/fc7fa233-8b50-4768-bbb5-8158e82ecf4f)

# DAY-8
  ## Question: Teams Power Users [Microsoft SQL Interview Question]
  
Write a query to identify the top 2 Power Users who sent the highest number of messages on Microsoft Teams in August 2022. Display the IDs of these 2 users along with the total number of messages they sent. Output the results in descending order based on the count of the messages.

Assumption:

No two users have sent the same number of messages in August 2022.
messages Table:

Full Question Link: [Link](https://datalemur.com/questions/teams-power-users)

## Solution: 

![Solution](https://github.com/Ramakm/SQL-Interview-Prep/assets/8182816/84e38a30-0290-422b-ba6b-a1c1deab358e)

## Question: Second Highest Salary (Oracle Interview Question)
  
 Write a solution to find the second highest salary from the Employee table. If there is no second highest salary, return null (return None in Pandas).

The result format is in the following example.

Full Question Link: [Link](https://leetcode.com/problems/second-highest-salary/description/)

## Solution: 

![Solution](https://github.com/Ramakm/SQL-Interview-Prep/assets/8182816/d7525137-79bf-4cd3-8a4f-6cfbb4fb8bd7)

# Day 9
## Question: Consecutive Numbers
  
Find all numbers that appear at least three times consecutively.

Return the result table in any order.

The result format is in the following example.

Full Question Link: [Link](https://leetcode.com/problems/consecutive-numbers/)

## Solution: 

![Solution](https://github.com/Ramakm/SQL-Interview-Prep/assets/8182816/7a90f767-89a0-4f4b-9150-cc9baac5b527)


# Day 10
## Question: Employees Earning More Than Their Managers

  Write a solution to find the employees who earn more than their managers. Return the result table in any order. The result format is in the following example.
Full Question Link: [Link](https://leetcode.com/problems/employees-earning-more-than-their-managers/?envType=list&envId=p764rm3e)

## Solution: 

![Solution] (https://github.com/Ramakm/SQL-Interview-Prep/assets/8182816/102ca150-6766-4427-8d12-b40d1434b36f)

## Question: Customers Who Never Order

Write a solution to find all customers who never order anything.

Return the result table in any order.

The result format is in the following example.

Full Question Link: [Link](https://leetcode.com/problems/customers-who-never-order/)

## Solution: 

![Solution](https://github.com/Ramakm/SQL-Interview-Prep/assets/8182816/afe86838-8b30-41dd-8265-ca75d12d689d)

# Day 11
## Question: Department Top Three Salaries

A company's executives are interested in seeing who earns the most money in each of the company's departments. A high earner in a department is an employee who has a salary in the top three unique salaries for that department.

Write a solution to find the employees who are high earners in each of the departments.

Return the result table in any order.

Full Question Link: [Link](https://leetcode.com/problems/department-top-three-salaries/?envType=list&envId=p764rm3e)

## Solution: 

![image](https://github.com/Ramakm/SQL-Interview-Prep/assets/8182816/319f27d5-a0d7-4dce-9a71-e4c68c8f1d57)

## Question: Department Highest Salary
 Write a solution to find employees who have the highest salary in each of the departments.

Return the result table in any order.

Full Question Link: [Link](https://leetcode.com/problems/department-highest-salary/?envType=list&envId=p764rm3e)

## Solution: 

![image](https://github.com/Ramakm/SQL-Interview-Prep/assets/8182816/5cb0f248-232c-4283-801b-dc5c06fd6f4d)


# Day 12
## Question: Scenario Based Question

Consider a scenario where you have a database table named Orders with columns such as 𝐎𝐫𝐝𝐞𝐫𝐈𝐃, 𝐂𝐮𝐬𝐭𝐨𝐦𝐞𝐫𝐈𝐃, 𝐚𝐧𝐝 𝐎𝐫𝐝𝐞𝐫𝐃𝐚𝐭𝐞. 𝐓𝐡𝐞 𝐂𝐮𝐬𝐭𝐨𝐦𝐞𝐫𝐈𝐃 column allows 𝐍𝐔𝐋𝐋 values, indicating orders from customers who haven't registered. However, you need to find the total number of orders for each customer along with their names, including those who haven't registered (𝐍𝐔𝐋𝐋, 𝐂𝐮𝐬𝐭𝐨𝐦𝐞𝐫𝐈𝐃).

### Full Question:

Tell me the challenges to retrieve the customer names and the total number of orders placed by each customer, considering 𝐍𝐔𝐋𝐋 values in the 𝐂𝐮𝐬𝐭𝐨𝐦𝐞𝐫𝐈𝐃 column. 


## Solution:

𝑆𝐸𝐿𝐸𝐶𝑇 
  𝐶𝑂𝐴𝐿𝐸𝑆𝐶𝐸(𝐶𝑢𝑠𝑡𝑜𝑚𝑒𝑟𝑁𝑎𝑚𝑒, '𝑁𝑜𝑡 𝑅𝑒𝑔𝑖𝑠𝑡𝑒𝑟𝑒𝑑') 𝐴𝑆 𝐶𝑢𝑠𝑡𝑜𝑚𝑒𝑟𝑁𝑎𝑚𝑒,
  𝐶𝑂𝑈𝑁𝑇(𝑂𝑟𝑑𝑒𝑟𝐼𝐷) 𝐴𝑆 𝑇𝑜𝑡𝑎𝑙𝑂𝑟𝑑𝑒𝑟𝑠
𝐹𝑅𝑂𝑀 𝑂𝑟𝑑𝑒𝑟𝑠 𝑜
𝐿𝐸𝐹𝑇 𝐽𝑂𝐼𝑁 𝐶𝑢𝑠𝑡𝑜𝑚𝑒𝑟𝑠 𝑐 𝑂𝑁 𝑜.𝐶𝑢𝑠𝑡𝑜𝑚𝑒𝑟𝐼𝐷 = 𝑐.𝐶𝑢𝑠𝑡𝑜𝑚𝑒𝑟𝐼𝐷
𝐺𝑅𝑂𝑈𝑃 𝐵𝑌 𝐶𝑢𝑠𝑡𝑜𝑚𝑒𝑟𝑁𝑎𝑚𝑒;

# Day 14

## 𝐐𝐮𝐞𝐬𝐭𝐢𝐨𝐧: 𝐒𝐜𝐞𝐧𝐚𝐫𝐢𝐨 𝐁𝐚𝐬𝐞𝐬 𝐒𝐐𝐋 𝐈𝐧𝐭𝐞𝐫𝐯𝐢𝐞𝐰 𝐐𝐮𝐞𝐬𝐭𝐢𝐨𝐧 (𝐇𝐂𝐋)❔
You have been provided with a table containing columns for 𝒖𝒔𝒆𝒓 𝑰𝑫, 𝒕𝒓𝒂𝒏𝒔𝒂𝒄𝒕𝒊𝒐𝒏 𝒂𝒎𝒐𝒖𝒏𝒕, 𝒂𝒏𝒅 𝒕𝒊𝒎𝒆 𝒐𝒇 𝒕𝒓𝒂𝒏𝒔𝒂𝒄𝒕𝒊𝒐𝒏 in datetime format. The positive transactions in the table are deposits and the negative transactions are withdrawals. The date in the output should be in the format ‘%𝒀-%𝒎-%𝒅’. Calculate the daily three-day rolling average for deposits made to a bank.

🔹𝗖𝗿𝗲𝗮𝘁𝗲 𝘁𝗮𝗯𝗹𝗲

CREATE TABLE BankTransactions (
  UserID INT,
  Amount DECIMAL(10, 2),
  TransactionTime DATETIME
);

🔹𝗜𝗻𝘀𝗲𝗿𝘁 𝘀𝗮𝗺𝗽𝗹𝗲 𝗱𝗮𝘁𝗮

INSERT INTO BankTransactions (UserID, Amount, TransactionTime)
VALUES
(1, 100.00, '2023-01-01 12:00:00'),
(2, -50.00, '2023-01-01 14:00:00'),
(1, 200.00, '2023-01-02 10:00:00'),
(2, 150.00, '2023-01-02 15:30:00'),
(1, 50.00, '2023-01-03 09:45:00'),
(2, -30.00, '2023-01-03 16:20:00');

## 𝐒𝐨𝐥𝐮𝐭𝐢𝐨𝐧:

-- 𝑄𝑢𝑒𝑟𝑦 𝑡𝑜 𝑐𝑎𝑙𝑐𝑢𝑙𝑎𝑡𝑒 𝑑𝑎𝑖𝑙𝑦 𝑡ℎ𝑟𝑒𝑒-𝑑𝑎𝑦 𝑟𝑜𝑙𝑙𝑖𝑛𝑔 𝑎𝑣𝑒𝑟𝑎𝑔𝑒 𝑓𝑜𝑟 𝑑𝑒𝑝𝑜𝑠𝑖𝑡𝑠

𝑊𝐼𝑇𝐻 𝐷𝑎𝑖𝑙𝑦𝐷𝑒𝑝𝑜𝑠𝑖𝑡𝑠 𝐴𝑆 (
  𝑆𝐸𝐿𝐸𝐶𝑇
    𝐷𝐴𝑇𝐸(𝑇𝑟𝑎𝑛𝑠𝑎𝑐𝑡𝑖𝑜𝑛𝑇𝑖𝑚𝑒) 𝐴𝑆 𝑇𝑟𝑎𝑛𝑠𝑎𝑐𝑡𝑖𝑜𝑛𝐷𝑎𝑡𝑒,
    𝑆𝑈𝑀(𝐶𝐴𝑆𝐸 𝑊𝐻𝐸𝑁 𝐴𝑚𝑜𝑢𝑛𝑡 > 0 𝑇𝐻𝐸𝑁 𝐴𝑚𝑜𝑢𝑛𝑡 𝐸𝐿𝑆𝐸 0 𝐸𝑁𝐷) 𝐴𝑆 𝐷𝑎𝑖𝑙𝑦𝐷𝑒𝑝𝑜𝑠𝑖𝑡
  𝐹𝑅𝑂𝑀 𝐵𝑎𝑛𝑘𝑇𝑟𝑎𝑛𝑠𝑎𝑐𝑡𝑖𝑜𝑛𝑠
  𝐺𝑅𝑂𝑈𝑃 𝐵𝑌 𝐷𝐴𝑇𝐸(𝑇𝑟𝑎𝑛𝑠𝑎𝑐𝑡𝑖𝑜𝑛𝑇𝑖𝑚𝑒)
)
𝑆𝐸𝐿𝐸𝐶𝑇
  𝑇𝑟𝑎𝑛𝑠𝑎𝑐𝑡𝑖𝑜𝑛𝐷𝑎𝑡𝑒,
  𝐷𝑎𝑖𝑙𝑦𝐷𝑒𝑝𝑜𝑠𝑖𝑡,
  𝐴𝑉𝐺(𝐷𝑎𝑖𝑙𝑦𝐷𝑒𝑝𝑜𝑠𝑖𝑡) 𝑂𝑉𝐸𝑅 (c𝑂𝑅𝐷𝐸𝑅 𝐵𝑌 𝑇𝑟𝑎𝑛𝑠𝑎𝑐𝑡𝑖𝑜𝑛𝐷𝑎𝑡𝑒 𝑅𝑂𝑊𝑆 𝐵𝐸𝑇𝑊𝐸𝐸𝑁 2 𝑃𝑅𝐸𝐶𝐸𝐷𝐼𝑁𝐺 𝐴𝑁𝐷 𝐶𝑈𝑅𝑅𝐸𝑁𝑇 𝑅𝑂𝑊) 𝐴𝑆 𝑇ℎ𝑟𝑒𝑒𝐷𝑎𝑦𝑅𝑜𝑙𝑙𝑖𝑛𝑔𝐴𝑣𝑒𝑟𝑎𝑔𝑒
𝐹𝑅𝑂𝑀 𝐷𝑎𝑖𝑙𝑦𝐷𝑒𝑝𝑜𝑠𝑖𝑡𝑠
𝑂𝑅𝐷𝐸𝑅 𝐵𝑌 𝑇𝑟𝑎𝑛𝑠𝑎𝑐𝑡𝑖𝑜𝑛𝐷𝑎𝑡𝑒;

𝑆𝐸𝐿𝐸𝐶𝑇 * 𝐹𝑅𝑂𝑀 𝑑𝑎𝑖𝑙𝑦_𝑑𝑒𝑝𝑜𝑠𝑖𝑡𝑠

# Day 15

## 𝐐𝐮𝐞𝐬𝐭𝐢𝐨𝐧: 𝐒𝐜𝐞𝐧𝐚𝐫𝐢𝐨 𝐁𝐚𝐬𝐞𝐬 𝐒𝐐𝐋 𝐈𝐧𝐭𝐞𝐫𝐯𝐢𝐞𝐰 𝐐𝐮𝐞𝐬𝐭𝐢𝐨𝐧 (𝐇𝐂𝐋)❔

There are three tables provided - ‘𝐩𝐚𝐠𝐞_𝐬𝐩𝐨𝐧𝐬𝐨𝐫𝐬𝐡𝐢𝐩𝐬’, ‘𝐫𝐞𝐜𝐨𝐦𝐦𝐞𝐧𝐝𝐚𝐭𝐢𝐨𝐧𝐬’, 𝐚𝐧𝐝 ‘𝐮𝐬𝐞𝐫𝐬’. The ‘sponsorship’ table has columns for 𝐩𝐚𝐠𝐞_𝐢𝐝, 𝐩𝐨𝐬𝐭𝐚𝐥_𝐜𝐨𝐝𝐞, 𝐚𝐧𝐝 𝐩𝐫𝐢𝐜𝐞, i.e., the value of the sponsorship. The ‘recommendations’ table contains the 𝐮𝐬𝐞𝐫_𝐢𝐝 and the 𝐩𝐚𝐠𝐞_𝐢𝐝of the recommended page. The ‘users’ table holds the user IDs and their postal codes. Pages are allowed to sponsor more than one postal code.

## Solution:

𝑊𝐼𝑇𝐻 𝑃𝑎𝑔𝑒𝑅𝑒𝑐𝑜𝑚𝑚𝑒𝑛𝑑𝑎𝑡𝑖𝑜𝑛𝑠 𝐴𝑆 (

  𝑆𝐸𝐿𝐸𝐶𝑇 𝑟.𝑝𝑎𝑔𝑒_𝑖𝑑, 𝑟.𝑢𝑠𝑒𝑟_𝑖𝑑, 𝑢.𝑝𝑜𝑠𝑡𝑎𝑙_𝑐𝑜𝑑𝑒
 𝐹𝑅𝑂𝑀 𝑟𝑒𝑐𝑜𝑚𝑚𝑒𝑛𝑑𝑎𝑡𝑖𝑜𝑛𝑠 𝑟
 𝐽𝑂𝐼𝑁 𝑢𝑠𝑒𝑟𝑠 𝑢 𝑂𝑁 𝑟.𝑢𝑠𝑒𝑟_𝑖𝑑 = 𝑢.𝑢𝑠𝑒𝑟_𝑖𝑑
)
𝑆𝐸𝐿𝐸𝐶𝑇 𝑝𝑠.𝑝𝑎𝑔𝑒_𝑖𝑑, 𝑝𝑠.𝑝𝑜𝑠𝑡𝑎𝑙_𝑐𝑜𝑑𝑒,
 𝐶𝑂𝑈𝑁𝑇(𝐷𝐼𝑆𝑇𝐼𝑁𝐶𝑇 𝑝𝑟.𝑢𝑠𝑒𝑟_𝑖𝑑) 𝐴𝑆 𝑟𝑒𝑐𝑜𝑚𝑚𝑒𝑛𝑑𝑒𝑑_𝑢𝑠𝑒𝑟𝑠,
 𝐶𝑂𝑈𝑁𝑇(𝐷𝐼𝑆𝑇𝐼𝑁𝐶𝑇 𝐶𝐴𝑆𝐸 𝑊𝐻𝐸𝑁 𝑝𝑟.𝑝𝑜𝑠𝑡𝑎𝑙_𝑐𝑜𝑑𝑒 = 𝑝𝑠.𝑝𝑜𝑠𝑡𝑎𝑙_𝑐𝑜𝑑𝑒 𝑇𝐻𝐸𝑁 𝑝𝑟.𝑢𝑠𝑒𝑟_𝑖𝑑 𝐸𝑁𝐷) 𝐴𝑆 𝑢𝑠𝑒𝑟𝑠_𝑖𝑛_𝑠𝑎𝑚𝑒_𝑝𝑜𝑠𝑡𝑎𝑙_𝑐𝑜𝑑𝑒,
 𝑅𝑂𝑈𝑁𝐷(𝐶𝑂𝑈𝑁𝑇(𝐷𝐼𝑆𝑇𝐼𝑁𝐶𝑇 𝐶𝐴𝑆𝐸 𝑊𝐻𝐸𝑁 𝑝𝑟.𝑝𝑜𝑠𝑡𝑎𝑙_𝑐𝑜𝑑𝑒 = 𝑝𝑠.𝑝𝑜𝑠𝑡𝑎𝑙_𝑐𝑜𝑑𝑒 𝑇𝐻𝐸𝑁 𝑝𝑟.𝑢𝑠𝑒𝑟_𝑖𝑑 𝐸𝑁𝐷) * 100.0 / 𝐶𝑂𝑈𝑁𝑇(𝐷𝐼𝑆𝑇𝐼𝑁𝐶𝑇 𝑝𝑟.𝑢𝑠𝑒𝑟_𝑖𝑑), 2) 𝐴𝑆 𝑝𝑒𝑟𝑐𝑒𝑛𝑡𝑎𝑔𝑒_𝑟𝑒𝑐𝑜𝑚𝑚𝑒𝑛𝑑𝑒𝑑_𝑖𝑛_𝑠𝑎𝑚𝑒_𝑝𝑜𝑠𝑡𝑎𝑙_𝑐𝑜𝑑𝑒
𝐹𝑅𝑂𝑀 𝑝𝑎𝑔𝑒_𝑠𝑝𝑜𝑛𝑠𝑜𝑟𝑠ℎ𝑖𝑝𝑠 𝑝𝑠
𝐿𝐸𝐹𝑇 𝐽𝑂𝐼𝑁 𝑃𝑎𝑔𝑒𝑅𝑒𝑐𝑜𝑚𝑚𝑒𝑛𝑑𝑎𝑡𝑖𝑜𝑛𝑠 𝑝𝑟 𝑂𝑁 𝑝𝑠.𝑝𝑎𝑔𝑒_𝑖𝑑 = 𝑝𝑟.𝑝𝑎𝑔𝑒_𝑖𝑑
𝐺𝑅𝑂𝑈𝑃 𝐵𝑌 𝑝𝑠.𝑝𝑎𝑔𝑒_𝑖𝑑, 𝑝𝑠.𝑝𝑜𝑠𝑡𝑎𝑙_𝑐𝑜𝑑𝑒;

# Day 16

## 𝐐𝐮𝐞𝐬𝐭𝐢𝐨𝐧: 𝐃𝐞𝐥𝐞𝐭𝐞 𝐃𝐮𝐩𝐥𝐢𝐜𝐚𝐭𝐞 𝐄𝐦𝐚𝐢𝐥𝐬

Write a solution to 𝐝𝐞𝐥𝐞𝐭𝐞 all duplicate emails, keeping only one unique email with the smallest id. For SQL users, please note that you are supposed to write a DELETE statement and not a SELECT one.

## Solution:

![Solution](https://github.com/Ramakm/SQL-Interview-Prep/assets/8182816/49591f30-d944-4f26-8c01-d20ae65f697c)


# Follow Me

### Linkedin : @ramakrushnamohapatra
### Twittee : @codewith_ram
